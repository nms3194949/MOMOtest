<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>è³‡ç”¢è² å‚µè¡¨è©¦ç®—ï¼ˆå«åŒ¯å‡º PNGï¼‰</title>
<!-- åŒ¯å‡ºåŠŸèƒ½å¥—ä»¶ -->
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<style>
  :root{
    --deep:#0A1221;--card:#0C152A;--line:#2a3550;
    --ink:#EDEFF5;--muted:#9AA4B2;
    --pos:#39C27A;--neg:#E25A5A;--gold:#C9A227;
  }
  html,body{margin:0;background:var(--deep);color:var(--ink);
    font-family:"Noto Sans TC","PingFang TC",sans-serif;}
  .wrap{max-width:800px;margin:0 auto;padding:24px;}
  h2{margin-top:24px;color:var(--gold);border-bottom:1px solid var(--line);padding-bottom:4px;}
  table{width:100%;border-collapse:collapse;margin-top:12px;}
  th,td{border-bottom:1px solid var(--line);padding:8px;text-align:center;}
  th{background:#111a2f;}
  select,input{background:#0f1a33;color:var(--ink);
    border:1px solid var(--line);border-radius:6px;padding:6px;width:100%;}
  input[type="number"]{text-align:right;}
  tfoot td{font-weight:700;}
  .summary{margin-top:24px;padding:12px;border:1px solid var(--line);
    border-radius:8px;background:var(--card);}
  .pos{color:var(--pos)}.neg{color:var(--neg)}
  .btn{background:var(--gold);color:#000;padding:8px 14px;
    border:none;border-radius:8px;font-weight:600;cursor:pointer;margin-top:12px;}
  .btn:hover{opacity:.9;}
</style>
</head>
<body>
<div class="wrap" id="captureArea">
  <h2>è³‡ç”¢</h2>
  <table id="tblAsset">
    <thead>
      <tr><th>è³‡ç”¢</th><th>é‡‘é¡ï¼ˆè¬å…ƒï¼‰</th><th>æœˆé…æ¯ï¼ˆå…ƒ/æœˆï¼‰</th></tr>
    </thead>
    <tbody>
      <tr>
        <td><select>
          <option value="">è«‹é¸æ“‡</option>
          <option>æ´»å­˜</option>
          <option>å®šå­˜</option>
          <option>è‚¡ç¥¨</option>
          <option>å°å¹£ä¿å–®</option>
          <option>å¤–å¹£ä¿å–®</option>
          <option>ä¸å‹•ç”¢</option>
          <option>ç§Ÿé‡‘</option>
        </select></td>
        <td><input type="number" step="0.01" placeholder="0"></td>
        <td><input type="number" step="1" placeholder="0"></td>
      </tr>
    </tbody>
  </table>
  <button class="btn" onclick="addRow('tblAsset')">ï¼‹ æ–°å¢è³‡ç”¢åˆ—</button>

  <h2>è² å‚µ</h2>
  <table id="tblDebt">
    <thead>
      <tr><th>è² å‚µ</th><th>é‡‘é¡ï¼ˆè¬å…ƒï¼‰</th><th>æœˆæ”¯å‡ºï¼ˆå…ƒ/æœˆï¼‰</th></tr>
    </thead>
    <tbody>
      <tr>
        <td><select>
          <option value="">è«‹é¸æ“‡</option>
          <option>ä¿¡è²¸</option>
          <option>è»Šè²¸</option>
          <option>æˆ¿è²¸</option>
          <option>å­¸è²¸</option>
          <option>å­è¦ªè²»</option>
        </select></td>
        <td><input type="number" step="0.01" placeholder="0"></td>
        <td><input type="number" step="1" placeholder="0"></td>
      </tr>
    </tbody>
  </table>
  <button class="btn" onclick="addRow('tblDebt')">ï¼‹ æ–°å¢è² å‚µåˆ—</button>

  <div class="summary">
    <p>è³‡ç”¢ç¸½é¡ï¼š<span id="sumAsset">0</span> è¬å…ƒ</p>
    <p>è² å‚µç¸½é¡ï¼š<span id="sumDebt">0</span> è¬å…ƒ</p>
    <p>æ¯æœˆæ·¨ç¾é‡‘æµï¼š<span id="netFlow" class="pos">0</span> å…ƒ/æœˆ</p>
  </div>
</div>

<div style="text-align:center;">
  <button class="btn" onclick="exportPNG()">ğŸ“¸ åŒ¯å‡º PNG</button>
</div>

<script>
function addRow(tblId){
  const tbl=document.getElementById(tblId).querySelector("tbody");
  const first=tbl.querySelector("tr");
  const clone=first.cloneNode(true);
  clone.querySelectorAll("input").forEach(i=>i.value="");
  clone.querySelectorAll("select").forEach(s=>s.value="");
  tbl.appendChild(clone);
  bindInputs();
}

function bindInputs(){
  document.querySelectorAll("input").forEach(el=>{
    el.removeEventListener("input",calc);
    el.addEventListener("input",calc);
  });
}

function calc(){
  let sumAsset=0,sumDebt=0,flowIn=0,flowOut=0;
  document.querySelectorAll("#tblAsset tbody tr").forEach(r=>{
    const v1=parseFloat(r.children[1].querySelector("input").value)||0;
    const v2=parseFloat(r.children[2].querySelector("input").value)||0;
    sumAsset+=v1; flowIn+=v2;
  });
  document.querySelectorAll("#tblDebt tbody tr").forEach(r=>{
    const v1=parseFloat(r.children[1].querySelector("input").value)||0;
    const v2=parseFloat(r.children[2].querySelector("input").value)||0;
    sumDebt+=v1; flowOut+=v2;
  });
  const net=flowIn-flowOut;
  document.getElementById("sumAsset").textContent=sumAsset.toFixed(2);
  document.getElementById("sumDebt").textContent=sumDebt.toFixed(2);
  const netEl=document.getElementById("netFlow");
  netEl.textContent=net.toFixed(0);
  netEl.className=net>=0?"pos":"neg";
}

// åŒ¯å‡º PNG
function exportPNG(){
  const target=document.getElementById("captureArea");
  html2canvas(target,{scale:2,backgroundColor:"#0A1221"}).then(canvas=>{
    const link=document.createElement("a");
    link.download="è³‡ç”¢è² å‚µè¡¨.png";
    link.href=canvas.toDataURL("image/png");
    link.click();
  });
}

bindInputs();
</script>
</body>
</html>