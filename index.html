<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>è³‡ç”¢è² å‚µè¡¨è©¦ç®—ï¼ˆå«å½™æ•´è¡¨èˆ‡åŒ¯å‡º PNGï¼‰</title>
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<style>
  :root{
    --deep:#0A1221;--card:#0C152A;--line:#2a3550;
    --ink:#EDEFF5;--muted:#9AA4B2;
    --pos:#39C27A;--neg:#E25A5A;--gold:#C9A227;
  }
  html,body{margin:0;background:var(--deep);color:var(--ink);
    font-family:"Noto Sans TC","PingFang TC",sans-serif;}
  .wrap{max-width:900px;margin:0 auto;padding:24px;}
  h2{margin:28px 0 8px;color:var(--gold);border-bottom:1px solid var(--line);padding-bottom:6px;}
  table{width:100%;border-collapse:collapse;margin-top:12px;}
  th,td{border-bottom:1px solid var(--line);padding:10px;text-align:center;vertical-align:top}
  th{background:#111a2f;}
  select,input{background:#0f1a33;color:var(--ink);
    border:1px solid var(--line);border-radius:6px;padding:8px;width:100%;}
  input[type="number"]{text-align:right;}
  .btn{background:var(--gold);color:#000;padding:9px 14px;border:none;border-radius:8px;
    font-weight:600;cursor:pointer;margin:10px 0 0 0}
  .btn:hover{opacity:.95;}
  .summary, .report, .actions{margin-top:20px;padding:14px;border:1px solid var(--line);
    border-radius:8px;background:var(--card);}
  .kv{display:flex;gap:18px;flex-wrap:wrap}
  .kv p{margin:0}
  .pos{color:var(--pos);font-weight:700}
  .neg{color:var(--neg);font-weight:700}
  .ul{list-style:disc;margin:6px 0 0 22px;padding:0}
  .actions{text-align:center}
</style>
</head>
<body>
<div class="wrap" id="captureArea">
  <h2>è³‡ç”¢</h2>
  <table id="tblAsset">
    <thead>
      <tr><th style="width:160px">è³‡ç”¢</th><th>é‡‘é¡ï¼ˆè¬å…ƒï¼‰</th><th>æœˆé…æ¯ï¼ˆå…ƒ/æœˆï¼‰</th></tr>
    </thead>
    <tbody>
      <tr>
        <td><select>
          <option value="">è«‹é¸æ“‡</option>
          <option>æ´»å­˜</option>
          <option>å®šå­˜</option>
          <option>è‚¡ç¥¨</option>
          <option>å°å¹£ä¿å–®</option>
          <option>å¤–å¹£ä¿å–®</option>
          <option>ä¸å‹•ç”¢</option>
          <option>ç§Ÿé‡‘</option>
        </select></td>
        <td><input type="number" step="0.01" placeholder="0"></td>
        <td><input type="number" step="1" placeholder="0"></td>
      </tr>
    </tbody>
  </table>
  <button class="btn" onclick="addRow('tblAsset')">ï¼‹ æ–°å¢è³‡ç”¢åˆ—</button>

  <h2>è² å‚µ</h2>
  <table id="tblDebt">
    <thead>
      <tr><th style="width:160px">è² å‚µ</th><th>é‡‘é¡ï¼ˆè¬å…ƒï¼‰</th><th>æœˆæ”¯å‡ºï¼ˆå…ƒ/æœˆï¼‰</th></tr>
    </thead>
    <tbody>
      <tr>
        <td><select>
          <option value="">è«‹é¸æ“‡</option>
          <option>ä¿¡è²¸</option>
          <option>è»Šè²¸</option>
          <option>æˆ¿è²¸</option>
          <option>å­¸è²¸</option>
          <option>å­è¦ªè²»</option>
        </select></td>
        <td><input type="number" step="0.01" placeholder="0"></td>
        <td><input type="number" step="1" placeholder="0"></td>
      </tr>
    </tbody>
  </table>
  <button class="btn" onclick="addRow('tblDebt')">ï¼‹ æ–°å¢è² å‚µåˆ—</button>

  <!-- å°è¨ˆå€ï¼šè³‡ç”¢ã€è² å‚µã€ç¾é‡‘æµä¸‰é … -->
  <div class="summary">
    <div class="kv">
      <p>è³‡ç”¢ç¸½é¡ï¼š<span id="sumAsset">0.00</span> è¬å…ƒ</p>
      <p>è² å‚µç¸½é¡ï¼š<span id="sumDebt">0.00</span> è¬å…ƒ</p>
      <p>æ¯æœˆæ”¶å…¥ç¾é‡‘æµï¼š<span id="flowIn">0</span> å…ƒ/æœˆ</p>
      <p>æ¯æœˆæ”¯å‡ºæ¼”é‡‘æµï¼š<span id="flowOut">0</span> å…ƒ/æœˆ</p>
      <p>æ¯æœˆæ·¨ç¾é‡‘æµï¼š<span id="netFlow" class="pos">0</span> å…ƒ/æœˆ</p>
    </div>
  </div>

  <!-- å½™æ•´è¡¨ï¼šç¬¬ä¸€è¡Œè³‡ç”¢ã€ç¬¬äºŒè¡Œè² å‚µï¼Œæ¢åˆ—å¡«å…¥è³‡è¨Š -->
  <div class="report">
    <h2>å½™æ•´è¡¨</h2>
    <table id="tblReport">
      <thead>
        <tr>
          <th style="width:120px">é¡åˆ¥</th>
          <th>æ¢åˆ—æ˜ç´°ï¼ˆé …ç›®ï½œé‡‘é¡ï¼ˆè¬å…ƒï¼‰ï½œæœˆç¾é‡‘æµï¼‰</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>è³‡ç”¢</td>
          <td><ul id="listAsset" class="ul"></ul></td>
        </tr>
        <tr>
          <td>è² å‚µ</td>
          <td><ul id="listDebt" class="ul"></ul></td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<div class="actions">
  <button class="btn" onclick="exportPNG()">ğŸ“¸ åŒ¯å‡º PNG</button>
</div>

<script>
function addRow(tblId){
  const tbl=document.getElementById(tblId).querySelector("tbody");
  const first=tbl.querySelector("tr");
  const clone=first.cloneNode(true);
  clone.querySelectorAll("input").forEach(i=>i.value="");
  clone.querySelectorAll("select").forEach(s=>s.value="");
  tbl.appendChild(clone);
  bindInputs();
  calc();
}

function bindInputs(){
  document.querySelectorAll("input,select").forEach(el=>{
    el.removeEventListener("input",calc);
    el.addEventListener("input",calc);
    el.removeEventListener("change",calc);
    el.addEventListener("change",calc);
  });
}

const nf0 = new Intl.NumberFormat('zh-TW', { maximumFractionDigits: 0 });
const nf2 = new Intl.NumberFormat('zh-TW', { minimumFractionDigits: 2, maximumFractionDigits: 2 });

function calc(){
  let sumAsset=0,sumDebt=0,flowIn=0,flowOut=0;
  const assetList = document.getElementById("listAsset");
  const debtList  = document.getElementById("listDebt");
  assetList.innerHTML = ""; debtList.innerHTML = "";

  // è³‡ç”¢ï¼šé‡‘é¡ï¼ˆè¬å…ƒï¼‰ã€æœˆé…æ¯ï¼ˆå…ƒ/æœˆï¼‰ï¼æ”¶å…¥ç¾é‡‘æµ
  document.querySelectorAll("#tblAsset tbody tr").forEach(r=>{
    const name=(r.children[0].querySelector("select").value||"").trim();
    const amt =parseFloat(r.children[1].querySelector("input").value)||0;
    const mon =parseFloat(r.children[2].querySelector("input").value)||0;
    sumAsset+=amt; flowIn+=mon;
    if(name || amt>0 || mon>0){
      const li=document.createElement("li");
      li.innerHTML=`${name||"æœªé¸æ“‡"} ï½œ ${nf2.format(amt)} è¬ ï½œ æœˆé…æ¯ ${nf0.format(mon)} å…ƒ`;
      assetList.appendChild(li);
    }
  });

  // è² å‚µï¼šé‡‘é¡ï¼ˆè¬å…ƒï¼‰ã€æœˆæ”¯å‡ºï¼ˆå…ƒ/æœˆï¼‰ï¼æ”¯å‡ºæ¼”é‡‘æµ
  document.querySelectorAll("#tblDebt tbody tr").forEach(r=>{
    const name=(r.children[0].querySelector("select").value||"").trim();
    const amt =parseFloat(r.children[1].querySelector("input").value)||0;
    const mon =parseFloat(r.children[2].querySelector("input").value)||0;
    sumDebt+=amt; flowOut+=mon;
    if(name || amt>0 || mon>0){
      const li=document.createElement("li");
      li.innerHTML=`${name||"æœªé¸æ“‡"} ï½œ ${nf2.format(amt)} è¬ ï½œ æœˆæ”¯å‡º ${nf0.format(mon)} å…ƒ`;
      debtList.appendChild(li);
    }
  });

  const net=flowIn-flowOut;

  document.getElementById("sumAsset").textContent=nf2.format(sumAsset);
  document.getElementById("sumDebt").textContent =nf2.format(sumDebt);
  document.getElementById("flowIn").textContent  =nf0.format(flowIn);
  document.getElementById("flowOut").textContent =nf0.format(flowOut);

  const netEl=document.getElementById("netFlow");
  netEl.textContent=nf0.format(net);
  netEl.className=net>=0?"pos":"neg";
}

// åŒ¯å‡º PNGï¼ˆåŒ…å«å½™æ•´è¡¨ï¼‰
function exportPNG(){
  const target=document.getElementById("captureArea");
  html2canvas(target,{scale:2,backgroundColor:"#0A1221"}).then(canvas=>{
    const link=document.createElement("a");
    link.download="è³‡ç”¢è² å‚µ_ç¾é‡‘æµå½™æ•´.png";
    link.href=canvas.toDataURL("image/png");
    link.click();
  });
}

bindInputs();
calc();
</script>
</body>
</html>